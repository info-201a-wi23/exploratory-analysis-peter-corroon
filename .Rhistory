group_by(year) %>%
summarize(injured= sum(injured, na.rm = TRUE))
View(injuries_by_year)
victims_by_year <- ms_df %>%
group_by(year) %>%
summarize(total_victims = sum(total_victims, na.rm = TRUE))
View(victims_by_year)
agg_table <- ms_df %>%
select(year, total_victims, injured, fatalities) %>%
arrange(desc(fatalities))
agg_table
#Join the data frames
df_list = list(victims_by_year, injuries_by_year, fatalities_by_year)
df_list
df_list %>% reduce(left_join, by = 'year')
View(df_list)
yearly_summary <- df_list %>% reduce(left_join, by = 'year')
yearly_summary
View(yearly_summary)
agg_table <- yearly_summary %>%
select(year, total_victims, injured, fatalities) %>%
arrange(desc(year)) %>%
slice_head(n = 5)
agg_table
View(agg_table)
agg_table <- yearly_summary %>%
select(year, total_victims, injured, fatalities) %>%
arrange(desc(year))
View(agg_table)
View(agg_table)
agg_table <- ms_df %>%
group_by(year)
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE))
agg_table <- ms_df %>%
group_by(year)
summarize(across(total_victims, injured, fatalities), sum, na.rm = TRUE)
agg_table <- ms_df %>%
group_by(year)
summarize(across(where(is.numeric), list(sum = sum, na.rm =TRUE)))
agg_table <- ms_df %>%
group_by(year)
summarise(across(where(is.numeric), list(sum = sum, na.rm =TRUE)))
agg_table <- ms_df %>%
group_by(year)
summarise(across(c(is.numeric), list(sum = sum, na.rm =TRUE)))
agg_table <- ms_df %>%
group_by(year) %>%
summarise(across(c(is.numeric), list(sum = sum, na.rm =TRUE)))
df <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE))
df
View(df)
df <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
View(df)
View(df)
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
View(agg_table)
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(nrow(),total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table <- ms_df %>%
group_by(year) %>%
nrow()
agg_table
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
View(agg_table)
per_year <- ms_df %>%
group_by(year) %>%
count("year")
per_year
View(per_year)
ms_df <- ms_df %>%
mutate(per_year)
agg_table <- ms_df %>%
mutate(per_year)
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
group_by(year) %>%
count("year")
agg_table
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
mutate(num_shootings = count("year"))
arrange(desc(year))
agg_table <- ms_df %>%
group_by(year) %>%
mutate(num_shootings = count("year"))
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
View(agg_table)
agg_table <- ms_df %>%
group_by(year) %>%
mutate(x = count("year"))
agg_table <- ms_df %>%
group_by(year) %>%
mutate(x = count("injured"))
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
View(agg_table)
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table
View(ms_df)
summary_info <- list()
summary_info$num_mass_shootings <- ms_df %>%
nrow()
#Calculate the total number of mass shootings up to the year 2023
summary_info$num_mass_shootings
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities))
summary_info$num_fatalities
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities))
pull(fatalities)
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities))
pull(total_fatalities)
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
#Calculate the total number of fatalities
summary_info$num_fatalities
summary_info$num_mass_shootings
summary_info
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
summary_info$year_most_shootings
summary_info
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(num_shootings == max(count))
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count)) %>%
pull(year, count)
summary_info$year_most_shootings
summary_info$year_most_shootings$year
year_most_shootings$year
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
summary_info$num_fatalities
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(victims)) %>%
pull(total_fatalities)
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(total_victims)) %>%
pull(total_fatalities)
summary_info$num_fatalities
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities) %>%
pull(total_fatalities)
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
summary_info$num_fatalities
summary_info$percent_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
#Calculate the number of cases used semiautomatic weapons
summary_info$percent_semiauto
summary_info$mental_health <- ms_df %>%
filter(prior_signs_mental_health_issues == "Yes") %>%
nrow()
summary_info$mental_health <- ms_df
summary_info$mental_health <- ms_df %>%
filter(prior_signs_mental_health_issues == "Yes") %>%
nrow()
summary_info$mental_health
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
summary_info$case_most_victims
View(summary_info)
View(case_most_victims)
View(summary_info$case_most_victims)
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities))
summary_info$case_most_victims
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
num_shootings_semiauto
summary_info$num_mass_shootings
percent_semiauto <- (num_shootings_semiauto/summary_info$num_mass_shootings)
percent_semiauto
percent_semiauto <- (num_shootings_semiauto/summary_info$num_mass_shootings) * 100
percent_semiauto
percent_semiauto <- round((num_shootings_semiauto/summary_info$num_mass_shootings) * 100)
percent_semiauto
summary_info$percent_semiauto <- round((num_shootings_semiauto/summary_info$num_mass_shootings) * 100)
summary_info$percent_semiauto
summary_info
summary_info <- list()
summary_info$num_mass_shootings <- ms_df %>%
nrow()
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count)) %>%
pull(year, count)
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
View(summary_info$case_most_victims)
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
summary_info$percent_semiauto <- round((num_shootings_semiauto/summary_info$num_mass_shootings) * 100)
summary_info
agg_table
summary_info$school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "school") %>%
nrow()
summary_info$school_shootings
summary_info$school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
summary_info$school_shootings
school <- ms_df %>%
filter(grepl('school', location.1)) %>%
nrow()
school
school <- ms_df %>%
filter(grepl('School', location.1)) %>%
nrow()
school
ms_df <- ms_df %>%
mutate("count" = 1)
ms_df
View(ms_df)
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(count, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table
ms_df <- ms_df %>%
mutate("mass_shootings" = 1)
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table
View(agg_table)
summary_info$num_mass_shootings
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
pull("2022")
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
pull(2)
agg_table
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
agg_table
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year))
View(agg_table)
#Create a list of summary information variables
summary_info <- list()
summary_info
summary_info$num_mass_shootings <- ms_df %>%
nrow()
#Calculate the total number of fatalities
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
#Calculate how many shootings took place at schools
summary_info$school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
#Calculate which year had the highest number of mass shootings, how many did it have?
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count)) %>%
pull(year, count)
#Calculate which case had the highest number of total victims, how many were there?
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
#Calculate the percentage of of cases that used semiautomatic weapons
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
summary_info
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count)) %>%
pull(year)
summary_info$year_most_shootings
summary_info$year_most_shootings_amount <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count)) %>%
pull(count)
summary_info$year_most_shootings_amount
summary_info$case_most_victims_count <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(total_victims)
summary_info$case_most_victims_count
summary_info$case_most_fatalities_count <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(total_victims)
summary_info$case_most_fatalities_count
summary_info$case_most_fatalities <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case)
summary_info$case_most_fatalities
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
summary_info$year_most_shootings
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities))
summary_info$case_most_victims
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
summary_info$case_most_victims
summary_info$num_mass_shootings <- ms_df %>%
nrow()
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
summary_info$school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
summary_info$percent_semiauto <- round((num_shootings_semiauto/summary_info$num_mass_shootings) * 100)
#Create a list of summary information variables
summary_info <- list()
summary_info$num_mass_shootings <- ms_df %>%
nrow()
#Calculate the total number of fatalities
summary_info$num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
#Calculate how many shootings took place at schools
summary_info$school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
#Calculate which year had the highest number of mass shootings, how many did it have?
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
#Calculate which case had the highest number of total victims, how many were there?
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
#Calculate the percentage of of cases that used semiautomatic weapons
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
summary_info$percent_semiauto <- round((num_shootings_semiauto/summary_info$num_mass_shootings) * 100)
summary_info
View(summary_info)
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, fatalities)
summary_info$case_most_victims
summary_info$school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
summary_info$school_shootings
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count)) %>%
pull(year, count)
summary_info$year_most_shootings
summary_info$year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
summary_info$year_most_shootings
summary_info$case_most_victims <- ms_df %>%
filter(fatalities == max(fatalities)) %>%
pull(case, total_victims)
summary_info$case_most_victims
ms_df
View(ms_df)
summary_info$case_most_victims <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(case, total_victims)
summary_info$case_most_victims
summary_info$case_most_victims <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(case)
summary_info$case_most_victims
summary_info$case_most_victims_amount <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(total_victims)
summary_info$case_most_victims_amount
library(knitr)
summary_info$year_most_shootings[2]
summary_info$year_most_shootings[1]
agg_table
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
slice_head(n = 13)
agg_table
#AGGREGATE TABLE
#Use dplyr to produce a table of aggregate information from the data set
# ------------------------------------------------------------------------------
#Load in necessary libraries
library("dplyr")
library("tidyverse")
library("ggplot2")
#Load in the data set
ms_df <- read.csv("~/Desktop/mass-shootings.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
#Clean the data:
#Add NA where there are missing values in the dataset
ms_df[ms_df == "-"] <- NA
ms_df[ms_df == "Unknown"] <- NA
ms_df[ms_df == "TBD"] <- NA
#Fix total_victims for "Tulsa medical center shooting"
ms_df[ms_df == "TK"] <- 4
#Make 'total_victims' and 'injured' numeric variables
ms_df$injured = as.numeric(ms_df$injured, na.rm = TRUE)
ms_df$total_victims = as.numeric(ms_df$total_victims, na.rm = TRUE)
#Add a column that counts each row as one mass shooting (this is simply to count the number of mass shootings for year in the aggregate table)
ms_df <- ms_df %>%
mutate("mass_shootings" = 1)
#Create aggregated data table showing:
# - each year
# - number of shootings
# - total number of victims
# - total number of injuries
# - total number of fatalities
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
slice_head(n = 13)
agg_table
source('chart2.R')
year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
#4. The year with the highest number of mass shootings, and how many
year_most_shootings
year_count <- year_most_shootings %>%
mutate(year = year_most_shootings$year)
year_count
year_most_shootings

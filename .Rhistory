shootings$gun_type <- gsub("semiautomatic rifle*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub("Semiautomatic Rifles*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub(".*rifle.*","Rifle", shootings$gun_type)
#filter for only up to 2022
shootings$date <- as.Date(shootings$date, "%m/%d/%y")
shootings <- shootings %>% filter(date != "2022-06-01") %>% filter(year <= "2022")
#new df
fatalities <- shootings %>% group_by(gun_type) %>% summarise(total_injured = sum(injured), total_fatalities = sum(fatalities))
#bar chart
df_long <- melt(fatalities, id.var = "gun_type")
ggplot(df_long, aes(x = gun_type, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(title = "Injuries and Deaths by Gun Type",
x = "Gun Type",
y = "Casualties") +
theme(axis.text.x = element_text(angle = 35, hjust = 1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_fill_discrete(name="Casualty",
labels=c("Injuries", "Fatalities")) +
theme(legend.background = element_rect(fill= "grey90"))
#bar chart
df_long <- melt(fatalities, id.var = "gun_type")
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
#read in data
shootings_df <- read.csv("~/Desktop/Mass-Shootings-Database.csv", stringsAsFactors = FALSE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
#read in data
shootings_df <- read.csv("~/Desktop/Mass-Shootings-Database.csv", stringsAsFactors = FALSE)
#Summary Information
#Use dplyr to produce a list of 5 summary values from the data set
# ------------------------------------------------------------------------------
#Load in necessary libraries
library("dplyr")
library("tidyverse")
library("ggplot2")
#Load in the data set
ms_df <- read.csv("~/Desktop/Mass-Shootings-Database.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
#Clean the data:
#Add NA where there are missing values in the dataset
ms_df[ms_df == "-"] <- NA
ms_df[ms_df == "Unknown"] <- NA
ms_df[ms_df == "TBD"] <- NA
#Fix total_victims for "Tulsa medical center shooting"
ms_df[ms_df == "TK"] <- 4
#Make 'total_victims' and 'injured' numeric variables
ms_df$injured = as.numeric(ms_df$injured, na.rm = TRUE)
ms_df$total_victims = as.numeric(ms_df$total_victims, na.rm = TRUE)
#Create a list of summary information variables
#1. The total number of mass shootings
num_mass_shootings <- ms_df %>%
nrow()
#2. The total number of fatalities
num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
#3. The number of mass shootings that happened at schools
school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
#4. The year with the highest number of mass shootings, and how many
year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
#5. The case with the highest number of total victims, and how many
case_most_victims <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(case)
case_most_victims_amount <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(total_victims)
#6. The percentage of of cases that involved semiautomatic weapons
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
percent_semiauto <- round((num_shootings_semiauto/num_mass_shootings) * 100)
#Add the variables into a list:
summary_info <- list()
summary_info$num_mass_shootings <- num_mass_shootings
summary_info$num_fatalities <- num_fatalities
summary_info$school_shootings <- school_shootings
summary_info$year_most_shootings <- year_most_shootings
summary_info$case_most_victims <- case_most_victims
summary_info$case_most_victims_amount <- case_most_victims_amount
summary_info$percent_semiauto <- percent_semiauto
summary_info
#AGGREGATE TABLE
#Use dplyr to produce a table of aggregate information from the data set
# ------------------------------------------------------------------------------
#Load in necessary libraries
library("dplyr")
library("tidyverse")
library("ggplot2")
#Load in the data set
ms_df <- read.csv("~/Desktop/Mass-Shootings-Database.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
View(ms_df)
#Clean the data:
#Add NA where there are missing values in the dataset
ms_df[ms_df == "-"] <- NA
ms_df[ms_df == "Unknown"] <- NA
ms_df[ms_df == "TBD"] <- NA
#Fix total_victims for "Tulsa medical center shooting"
ms_df[ms_df == "TK"] <- 4
#Make 'total_victims' and 'injured' numeric variables
ms_df$injured = as.numeric(ms_df$injured, na.rm = TRUE)
ms_df$total_victims = as.numeric(ms_df$total_victims, na.rm = TRUE)
#Add a column that counts each row as one mass shooting (this is simply to count the number of mass shootings for year in the aggregate table)
ms_df <- ms_df %>%
mutate("mass_shootings" = 1)
#Create aggregated data table showing:
# - each year
# - number of shootings
# - total number of victims
# - total number of injuries
# - total number of fatalities
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
slice_head(n = 13)
agg_table
#load libraries
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
#read in data
shootings_df <- read.csv("~/Desktop/Mass-Shootings-Database.csv", stringsAsFactors = FALSE)
shootings_df[shootings_df == "-"] <- NA
shootings_df[shootings_df == "Unknown"] <- NA
shootings_df[shootings_df == "TBD"] <- NA
num_shootings_df <- transform(shootings_df,
total_victims = as.numeric(total_victims))
num_shootings_df <- transform(num_shootings_df,
injured = as.numeric(injured))
num_shootings_df <- transform(num_shootings_df,
fatalities = as.numeric(fatalities))
num_shootings_df <- transform(num_shootings_df,
age_of_shooter = as.numeric(age_of_shooter))
#str(num_shootings_df)
#create more general column for gun type
shootings <- num_shootings_df %>% mutate(gun_type = gsub(".*;.*","More Than One Type", weapon_type))
shootings$gun_type <- gsub(".*;.*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".*,.*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".* and .*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".*semiautomatic handgun.*","Semiautomatic Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*handgun.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*semiautomatic pistol.*","Semiautomatic Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*pistol.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*revolver.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*shotgun.*","Shotgun", shootings$gun_type)
shootings$gun_type <- gsub("semiautomatic rifle*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub("Semiautomatic Rifles*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub(".*rifle.*","Rifle", shootings$gun_type)
#filter for only up to 2022
shootings$date <- as.Date(shootings$date, "%m/%d/%y")
shootings <- shootings %>% filter(date != "2022-06-01") %>% filter(year <= "2022")
#new df
fatalities <- shootings %>% group_by(gun_type) %>% summarise(total_injured = sum(injured), total_fatalities = sum(fatalities))
#bar chart
df_long <- melt(fatalities, id.var = "gun_type")
ggplot(df_long, aes(x = gun_type, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(title = "Injuries and Deaths by Gun Type",
x = "Gun Type",
y = "Casualties") +
theme(axis.text.x = element_text(angle = 35, hjust = 1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_fill_discrete(name="Casualty",
labels=c("Injuries", "Fatalities")) +
theme(legend.background = element_rect(fill= "grey90"))
ggplot(df_long, aes(x = gun_type, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(title = "Injuries and Deaths by Gun Type",
x = "Gun Type",
y = "Casualties") +
theme(axis.text.x = element_text(angle = 35, hjust = 1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_fill_discrete(name="Casualty",
labels=c("Injuries", "Fatalities")) +
theme(legend.background = element_rect(fill= "grey90"))
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
#AGGREGATE TABLE
#Use dplyr to produce a table of aggregate information from the data set
# ------------------------------------------------------------------------------
#Load in necessary libraries
library("dplyr")
library("tidyverse")
library("ggplot2")
#Load in the data set
ms_df <- read.csv("~/Desktop/Mass-Shootings-Database.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
View(ms_df)
#Clean the data:
#Add NA where there are missing values in the dataset
ms_df[ms_df == "-"] <- NA
ms_df[ms_df == "Unknown"] <- NA
ms_df[ms_df == "TBD"] <- NA
#Fix total_victims for "Tulsa medical center shooting"
ms_df[ms_df == "TK"] <- 4
#Make 'total_victims' and 'injured' numeric variables
ms_df$injured = as.numeric(ms_df$injured, na.rm = TRUE)
ms_df$total_victims = as.numeric(ms_df$total_victims, na.rm = TRUE)
#Add a column that counts each row as one mass shooting (this is simply to count the number of mass shootings for year in the aggregate table)
ms_df <- ms_df %>%
mutate("mass_shootings" = 1)
#Create aggregated data table showing:
# - each year
# - number of shootings
# - total number of victims
# - total number of injuries
# - total number of fatalities
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
slice_head(n = 13)
agg_table
ds <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE)
View(ds)
ms_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
#Summary Information
#Use dplyr to produce a list of 5 summary values from the data set
# ------------------------------------------------------------------------------
#Load in necessary libraries
library("dplyr")
library("tidyverse")
library("ggplot2")
#Load in the data set
ms_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
#Clean the data:
#Add NA where there are missing values in the dataset
ms_df[ms_df == "-"] <- NA
ms_df[ms_df == "Unknown"] <- NA
ms_df[ms_df == "TBD"] <- NA
#Fix total_victims for "Tulsa medical center shooting"
ms_df[ms_df == "TK"] <- 4
#Make 'total_victims' and 'injured' numeric variables
ms_df$injured = as.numeric(ms_df$injured, na.rm = TRUE)
ms_df$total_victims = as.numeric(ms_df$total_victims, na.rm = TRUE)
#Create a list of summary information variables
#1. The total number of mass shootings
num_mass_shootings <- ms_df %>%
nrow()
#2. The total number of fatalities
num_fatalities <- ms_df %>%
summarize(total_fatalities = sum(fatalities)) %>%
pull(total_fatalities)
#3. The number of mass shootings that happened at schools
school_shootings <- ms_df %>%
group_by(location.1) %>%
filter(location.1 == "School") %>%
nrow()
#4. The year with the highest number of mass shootings, and how many
year_most_shootings <- ms_df %>%
group_by(year) %>%
summarize(count = n()) %>%
filter(count == max(count))
#5. The case with the highest number of total victims, and how many
case_most_victims <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(case)
case_most_victims_amount <- ms_df %>%
filter(total_victims == max(total_victims)) %>%
pull(total_victims)
#6. The percentage of of cases that involved semiautomatic weapons
num_shootings_semiauto <- ms_df %>%
filter(grepl('semiautomatic', weapon_type)) %>%
nrow()
percent_semiauto <- round((num_shootings_semiauto/num_mass_shootings) * 100)
#Add the variables into a list:
summary_info <- list()
summary_info$num_mass_shootings <- num_mass_shootings
summary_info$num_fatalities <- num_fatalities
summary_info$school_shootings <- school_shootings
summary_info$year_most_shootings <- year_most_shootings
summary_info$case_most_victims <- case_most_victims
summary_info$case_most_victims_amount <- case_most_victims_amount
summary_info$percent_semiauto <- percent_semiauto
summary_info
ms_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
#AGGREGATE TABLE
#Use dplyr to produce a table of aggregate information from the data set
# ------------------------------------------------------------------------------
#Load in necessary libraries
library("dplyr")
library("tidyverse")
library("ggplot2")
#Load in the data set
ms_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
View(ms_df)
#Clean the data:
#Add NA where there are missing values in the dataset
ms_df[ms_df == "-"] <- NA
ms_df[ms_df == "Unknown"] <- NA
ms_df[ms_df == "TBD"] <- NA
#Fix total_victims for "Tulsa medical center shooting"
ms_df[ms_df == "TK"] <- 4
#Make 'total_victims' and 'injured' numeric variables
ms_df$injured = as.numeric(ms_df$injured, na.rm = TRUE)
ms_df$total_victims = as.numeric(ms_df$total_victims, na.rm = TRUE)
#Add a column that counts each row as one mass shooting (this is simply to count the number of mass shootings for year in the aggregate table)
ms_df <- ms_df %>%
mutate("mass_shootings" = 1)
#Create aggregated data table showing:
# - each year
# - number of shootings
# - total number of victims
# - total number of injuries
# - total number of fatalities
agg_table <- ms_df %>%
group_by(year) %>%
summarize(across(c(mass_shootings, total_victims, injured, fatalities), sum, na.rm = TRUE)) %>%
arrange(desc(year)) %>%
slice_head(n = 13)
agg_table
#load libraries
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
#read in data
shootings_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE)
shootings_df[shootings_df == "-"] <- NA
shootings_df[shootings_df == "Unknown"] <- NA
shootings_df[shootings_df == "TBD"] <- NA
num_shootings_df <- transform(shootings_df,
total_victims = as.numeric(total_victims))
num_shootings_df <- transform(num_shootings_df,
injured = as.numeric(injured))
num_shootings_df <- transform(num_shootings_df,
fatalities = as.numeric(fatalities))
num_shootings_df <- transform(num_shootings_df,
age_of_shooter = as.numeric(age_of_shooter))
#str(num_shootings_df)
#create more general column for gun type
shootings <- num_shootings_df %>% mutate(gun_type = gsub(".*;.*","More Than One Type", weapon_type))
shootings$gun_type <- gsub(".*;.*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".*,.*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".* and .*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".*semiautomatic handgun.*","Semiautomatic Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*handgun.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*semiautomatic pistol.*","Semiautomatic Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*pistol.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*revolver.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*shotgun.*","Shotgun", shootings$gun_type)
shootings$gun_type <- gsub("semiautomatic rifle*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub("Semiautomatic Rifles*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub(".*rifle.*","Rifle", shootings$gun_type)
#filter for only up to 2022
shootings$date <- as.Date(shootings$date, "%m/%d/%y")
shootings <- shootings %>% filter(date != "2022-06-01") %>% filter(year <= "2022")
#new df
fatalities <- shootings %>% group_by(gun_type) %>% summarise(total_injured = sum(injured), total_fatalities = sum(fatalities))
#bar chart
df_long <- melt(fatalities, id.var = "gun_type")
ggplot(df_long, aes(x = gun_type, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(title = "Injuries and Deaths by Gun Type",
x = "Gun Type",
y = "Casualties") +
theme(axis.text.x = element_text(angle = 35, hjust = 1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_fill_discrete(name="Casualty",
labels=c("Injuries", "Fatalities")) +
theme(legend.background = element_rect(fill= "grey90"))
#Chart 3
#load libraries
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
library(parsedate)
library(lubridate)
#read csv
shootings_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE) %>%
filter(year != "2023")
#clean data
shootings_df[shootings_df == "-"] <- NA
shootings_df[shootings_df == "Unknown"] <- NA
shootings_df[shootings_df == "TBD"] <- NA
shootings_df$total_victims[shootings_df$total_victims == "TK"] <- 10
shootings_df$date <- parse_date(dates = shootings_df$date)
shootings_df$total_victims <- as.numeric(shootings_df$total_victims)
shootings_df <- shootings_df[order(shootings_df$date),]
shootings_df <- shootings_df %>%
mutate(victim_cum = cumsum(total_victims))
#line graph
ggplot(shootings_df) +
geom_line(aes(x = date, y = victim_cum, color = "red")) +
labs(title = "Total Victims of Mass Shootings Over Time", x = "Date", y = "Number of Victims") +
theme(legend.position = "none")
#Chart 1
rm(list = ls())
shootings_data <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE)
library("dplyr")
library("tidyverse")
shootings_data[shootings_data == "-"] <- NA
shootings_data[shootings_data == "Unknown"] <- NA
shootings_data[shootings_data == "TBD"] <- NA
shootings_data
install.packages("maps")
# Load libraries
library("ggplot2")
#  library("plotly")
library("dplyr")
state_shape <- map_data("state")
no_na_lat_long <- shootings_data %>%
drop_na(latitude) %>%
drop_na(longitude)
num_lat_long <- transform(no_na_lat_long,
latitude = as.numeric(latitude))
num_lat_long <- transform(num_lat_long, longitude = as.numeric(longitude))
str(num_lat_long)
ggplot(data = state_shape) +
geom_polygon(aes(x = long,
y = lat,
group = group)) +
geom_point(data = num_lat_long, aes(x = longitude,
y = latitude, color = "red")) +
coord_map(xlim = c(-125, -65), ylim = c(50, 25)) +
labs(
title = "Locations of US Mass Shootings",
x = "Longitude",
y = "Latitude",
color = "Location") +
theme(
plot.background = element_blank(),
legend.position = "none")
blank_theme <- theme_bw() +
theme(
axis.line = element_blank(), # remove axis lines
axis.text = element_blank(), # remove axis labels
axis.ticks = element_blank(), # remove axis ticks
axis.title = element_blank(), # remove axis titles
plot.background = element_blank(), # remove gray background
panel.grid.major = element_blank(), # remove major grid lines
panel.grid.minor = element_blank(), # remove minor grid lines
panel.border = element_blank(), # remove border around plot
)
#load libraries
library(tidyverse)
library(dplyr)
library(ggplot2)
library(reshape2)
#read in data
shootings_df <- read.csv("Mass-Shootings-Database-copy.csv", stringsAsFactors = FALSE)
shootings_df[shootings_df == "-"] <- NA
shootings_df[shootings_df == "Unknown"] <- NA
shootings_df[shootings_df == "TBD"] <- NA
num_shootings_df <- transform(shootings_df,
total_victims = as.numeric(total_victims))
num_shootings_df <- transform(num_shootings_df,
injured = as.numeric(injured))
num_shootings_df <- transform(num_shootings_df,
fatalities = as.numeric(fatalities))
num_shootings_df <- transform(num_shootings_df,
age_of_shooter = as.numeric(age_of_shooter))
#str(num_shootings_df)
#create more general column for gun type
shootings <- num_shootings_df %>% mutate(gun_type = gsub(".*;.*","More Than One Type", weapon_type))
shootings$gun_type <- gsub(".*;.*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".*,.*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".* and .*","More Than One Type", shootings$gun_type)
shootings$gun_type <- gsub(".*semiautomatic handgun.*","Semiautomatic Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*handgun.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*semiautomatic pistol.*","Semiautomatic Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*pistol.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*revolver.*","Handgun", shootings$gun_type)
shootings$gun_type <- gsub(".*shotgun.*","Shotgun", shootings$gun_type)
shootings$gun_type <- gsub("semiautomatic rifle*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub("Semiautomatic Rifles*","Semiautomatic Rifle", shootings$gun_type)
shootings$gun_type <- gsub(".*rifle.*","Rifle", shootings$gun_type)
#filter for only up to 2022
shootings$date <- as.Date(shootings$date, "%m/%d/%y")
shootings <- shootings %>% filter(date != "2022-06-01") %>% filter(year <= "2022")
#new df
fatalities <- shootings %>% group_by(gun_type) %>% summarise(total_injured = sum(injured), total_fatalities = sum(fatalities))
#bar chart
df_long <- melt(fatalities, id.var = "gun_type")
ggplot(df_long, aes(x = gun_type, y = value, fill = variable)) +
geom_bar(stat = "identity") +
labs(title = "Injuries and Deaths by Gun Type",
x = "Gun Type",
y = "Casualties") +
theme(axis.text.x = element_text(angle = 35, hjust = 1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_fill_discrete(name="Casualty",
labels=c("Injuries", "Fatalities")) +
theme(legend.background = element_rect(fill= "grey90"))
```{r setup, include=FALSE}
```{r setup, include=FALSE}
library(knitr)
library(dplyr)
library(ggplot2)
library(tidyverse)
library(reshape2)
library(parsedate)
library(lubridate)
